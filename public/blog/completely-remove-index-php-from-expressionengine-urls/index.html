<!DOCTYPE html>
<!--[if lt IE 7 ]>	<html class="ie ie6 lte9 lte8 lte7"> <![endif]--> 
<!--[if IE 7 ]>		<html class="ie ie7 lte9 lte8 lte7"> <![endif]--> 
<!--[if IE 8 ]>		<html class="ie ie8 lte9 lte8"> <![endif]--> 
<!--[if IE 9 ]>		<html class="ie ie9 lte9"> <![endif]--> 
<!--[if (gt IE 9)|!(IE)]><!--> <html> <!--<![endif]-->
<head>
<!--
 _     _             _       
| |   / /           (_)      
| |_ / / ____ _   _ _ ____  
|  _  | | ___ | | | | |  _ \ 
| |  \ \| ____|\ V /| | | | |
|_|   \_)_____) \_/ |_|_| |_|                        
 _______ _                                        
(__   __) |                                       
   | |  | |__   ___  ____  ____   ___  ___  ____  
   | |  |  _ \ / _ \|    \|  _ \ /___)/ _ \|  _ \ 
   | |  | | | | |_| | | | | |_| |___ | |_| | | | |
   |_|  |_| |_|\___/|_|_|_|  __/(___/ \___/|_| |_|
                          |_|  
-->
<meta charset="utf-8"> 
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>Completely Remove index.php from ExpressionEngine URLs | Kevin Thompson</title>
<meta name="description" content="Kevin Thompson is an web application developer and user experience engineer from Oceanside, Ca"> 
<meta name="keywords" content="Kevin Thompson, web development in san diego, web developer in san diego, san diego user experience, small business website, expressionengine developer"> 
<meta name="author" content="Kevin Thompson"> 
<meta name="copyright" content="Kevin Thompson">
<meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;"> 
<link rel="icon" href="/favicon.ico" type="image/x-icon" /> 
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" /> 
<link rel="stylesheet" href="/css/reset.css" media="all" />
<link rel="stylesheet" href="/css/fonts.css" media="all" />
<link rel="stylesheet" href="/css/screen.css" media="all" />
<link rel="stylesheet" href="/css/print.css" media="print" />
<script type="text/javascript">
	var html = document.getElementsByTagName('html')[0];
	html.className = (html.className != '' ? html.className + ' ' : '') + 'js';
	/mobile/i.test(navigator.userAgent) && !location.hash && setTimeout(function () { window.scrollTo(0, 1); }, 1000);
</script>
<!--[if lt IE 9]><script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js">IE7_PNG_SUFFIX=".png";</script><![endif]-->
<!-- Google Analytics -->
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-24584832-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>
<body class=" blog single-entry">
<header>
  <div class="module rounded-bottom dark">
    <h1 class="logo h2"><a href="/">Kevin Thompson</a></h1>
    <ul class="menu">
      <li>
        <a href="/blog/" data-icon="N" class="bevel" title="Blog">Blog</a> 
        <a href="/blog/start-required-processes-on-pow-application-boot/" class="latest-post">Start Required Processes on Pow Application Boot</a>
      </li>
    </ul>
  </div>
</header>
<div class="page">
  
  <div class="line">
  <div class="unit size-two-thirds pvn">
    <article class="post">  
      <div class="module">
        <h1 class="title">Completely Remove index.php from ExpressionEngine URLs</h1>
        <span class="date">March  4, 2011</span>
        <p>While there are a <a href="http://expressionengine.com/wiki/Remove_index.php_From_URLs/">number of known solutions</a> for removing <code>index.php</code> from ExpressionEngine URLs, few developers realize that although URLs now resolve without <code>index.php</code>, the previous URLs including <code>index.php</code> also still exist.<!--more--></p>

<!-- more -->


<h2>The Example</h2>

<p>At the time of this writing, if you were to visit <a href="http://expressionengine.com/index.php/overview/">http://expressionengine.com/index.php/overview/</a> or <a href="http://expressionengine.com/overview/">http://expressionengine.com/overview/</a>, you&rsquo;d be presented with the exact same page. Having the same content resolve at two distinct URLs can potentially harm <a href="http://www.google.com/support/webmasters/bin/answer.py?hl=en&amp;answer=66359">your search engine rankings</a> and disrupt your analytics.</p>

<h2>The Rules</h2>

<script src="https://gist.github.com/798018.js?file=.htaccess"></script>


<p class="gist-link"><a href="https://gist.github.com/798018">Available on Github &raquo;</a></p>


<h2>The Story</h2>

<p>A few weeks ago, while optimizing an ExpressionEngine installation, I was working to ensure that all invalid URLs either redirected to the appropriate URL, or returned a 404 error as necessary. During this process, I realized that URLs beginning with <code>index.php</code> still resolved, even though I thought I had removed <code>index.php</code> completely from URLs. I struggled for a few hours with various mod_rewrite rules in my <code>.htaccess</code> file but they all lead me into redirect loops. I ultimately settled on adding a <code>&lt;link rel="canonical" href="..." /&gt;</code> tag to all pages and added a rule to my <code>robots.txt</code> file that would stop spiders from crawling the additional URLs.</p>

<p>Although duplicate content was no longer a concern, as search engines should no longer see the <code>index.php</code> URLs, the fact that they existed, and that a user could potentially find the duplicate URL, still bothered me. I could have redirected users using PHP, but in this instance it seemed like a bit of a hack, and I couldn&rsquo;t shake the feeling that there had to be a way to solve this with a mod_rewrite rule. I happened to be working through this issue on a thursday evening, so I decided to pop into the weekly <a href="https://eescreencasts.campfirenow.com/room/177927">ExpressionEngine Help Chat</a> to see if anyone else had come across it.</p>

<p>I asked my question and received a number of responses confirming the issue, but not offering much in the way of a solution. I left the chat open and continued tinkering with my <code>.htaccess</code> file. After a while I decided to check back in on the EE Help Chat, and to my surprise, <a href="http://twitter.com/erikreagan">Erick Reagan</a> and <a href="http://twitter.com/nevinlyne">Nevin Lyne</a> had worked out a potential solution:</p>

<pre><code>RewriteCond %{THE_REQUEST} ^[^/]*/index\.php [NC]
RewriteRule ^index\.php(.+) $1 [R=301,L]
</code></pre>

<p>I quickly modified my .htaccess file and sure enough, this new rule was able to catch URL requests beginning with index.php and issue a 301 redirect to the correct URL. The trick to circumventing the redirect loops I was encountering was using <code>%{THE_REQUEST}</code> to match the request string as opposed to the actual URL.</p>

<p>Thanks to Erik and Nevin my OCD has been suppressed, for now.</p>

<h2>The Update</h2>

<p>In the comments, <a href="http://kevinthompson.info/blog/completely-remove-index-php-from-expressionengine-urls/#comment-15">Manuel</a> pointed out the fact that the rules suggested by Erik and Nevin would break any <code>POST</code> request sent to an <code>index.php</code> URL. To resolve this, he suggested adding the following condition to the rewrite (which has already been included in the example above) that would restrict it to only <code>GET</code> requests:</p>

<pre><code>RewriteCond %{THE_REQUEST} ^GET
</code></pre>

      </div>
    </article>
  </div>
  <div class="last unit size-one-third ptm">
    
    






  
  

  

  
    
  
  

  
  

  

  
    
  
  

  
  

  

  
    
  
  

  
  

  

  
    
  
  

  
  

  

  
    
  
  

  
  

  

  
    
  
  

  
  

  
    
    
  

  
  

  
  
    
    
  

  

  
  


<div class="post-nav sticky">
  <ul class="article-nav mbn clear">
    <li class="previous"><a href="/blog/init" >&laquo; Previous Post</a></li> 
    <li class="next"><a href="/blog/discovering-version-control-and-deployment-systems">Next Post &raquo;</a></li>
  </ul>
</div>
  </div>
  <div class="line">
    <div class="unit size-two-thirds">
      <hr class="hires" />
      <section class="comments module">
  <h1>Comments</h1>
  
  <div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'kevinthompson'; // required: replace example with your forum shortname

      // The following are highly recommended additional parameters. Remove the slashes in front to use.
      // var disqus_identifier = 'unique_dynamic_id_1234';
      // var disqus_url = 'http://example.com/permalink-to-page.html';

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>

</section>

<hr />
    </div>
    <div class="last unit size-one-third"></div>
  </div>
</div>

  <div class="module dark footer">
    <div class="divided line">
      <div class="equal unit size-one-half">
        <h3>Who's this Kevin Thompson character?</h3>
        <p>Mild-mannered developer by day, caffeine-fueled autodidact by night. I leverage my talent and experience as a professional web developer to help people solve problems and build successful businesses.</p>
        <p>You can glean more by perusing <a href="/blog/">my blog</a> or taking a look at <a href="http://github.com/kevinthompson">my code</a>, and if you have any questions <a href="mailto:kevin@kevinthompson.info">email me</a> and we can chat.</p>
      </div>
      <div class="equal unit size-one-fourth">
        <hr class="lores" />
        <dl>
          <dt>Email</dt>
          <dd><a href="mailto:{contact-email}">kevin@kevinthompson.info</a></dd>
      
          <dt>Skype</dt>
          <dd><a href="skype:{contact-skype}?add">thompson.kevind</a></dd>
        </dl>
      </div>
      <div class="last equal unit size-one-fourth">
        <hr class="lores" />
        <h3>Looking for more?</h3>
        <ul class="social">
          <li><a href="/feed/index.xml" class="rss-link">Subscribe to My Blog</a></li>
          <li><a href="http://twitter.com/kevinthompson" class="twitter-link">Follow Me on Twitter</a><span class="twitter-follow-button"></span></li>
          <li><a href="http://github.com/kevinthompson">Dissect My Code on Github</a></li>
          <li><a href="http://linkedin.com/in/kevindthompson">View My Resume on LinkedIn</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>
<footer>
  <span class="small copyright">&copy; Kevin Thompson 2012 &mdash; Code, Content &amp; Design</span>
  <a href="http://twitter.com/kevinthompson" class="twitter-follow-button" data-align="right" data-text-color="888888" data-link-color="3ba1b3">Follow @kevinthompson</a>
  <script src="http://platform.twitter.com/widgets.js" type="text/javascript"></script>
</footer>

<!-- Load jQuery -->
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script>!window.jQuery && document.write(unescape('%3Cscript src="/js/jquery.min.js"%3E%3C/script%3E'))</script>

<!-- Load JavaScript -->
<script src="/js/jquery.equalHeightColumns.js"></script>
<script src="/js/jquery.sticky.js"></script>
<script src="/js/jquery.touchSwipe.js"></script>
<script src="/js/jquery.pjax.js"></script> 
<script src="/js/github.js"></script> 
<script src="/js/script.js"></script>
  
</body>
</html>